"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,i=e},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}!function(){window.HIKO=_objectSpread(_objectSpread({},window.HIKO),{},{extension:!0,ajax_calls:0});var e=30,t={replace:!0,return_url:!0,enable:!0,key:"retry"},n={};if(function(e){e||(e="info");for(var t={debug:2,info:3,warn:4,error:5},o=0,a=Object.keys(t);o<a.length;o++){var i=a[o];n[i]=t[i]<t[e]?function(){}:console[i].bind(window.console,"".concat(i.toUpperCase(),": "))}n.debug("init log ".concat(e))}(function(){if(!document.currentScript)return{};var e=new URLSearchParams(document.currentScript.src);return{cid:e.get("cid"),level:e.get("level")}}().level),window.HIKO.script)n.debug("script > exit");else{var o="hiko_socials",a="abw",i="g_id_onload",r="g_id_marketing";if(!(location.protocol.indexOf("http")<0||/^(\/[a-zA-Z]{2,3}(-[a-zA-Z]{2})?)?\/challenge($|\?)/.test(location.pathname))){var c,d=window.Shopify.shop,s="undefined"!=typeof __st&&__st.cid?__st.cid:void 0,l=!1;document.addEventListener("hiko",(function(e){return n.debug("catch event: ".concat(JSON.stringify(e.detail)))})),n.debug("0226-2");var u,p,m=!1,f=(u=location.href,p={},u.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,t,n){return p[t]=n})),p).ha;f&&/^[a-f0-9]{78,}$/.test(f)?L(f).then(C):(document.addEventListener("onetap",(function(e){if(n.debug("catch onetap event: ".concat(JSON.stringify(e.detail))),"display"===e.detail.action){var t,o,a,d=document.getElementById(i),s=function(){if("iframe"===e.detail.type){var t=d.querySelector("iframe");if("0px"===getComputedStyle(t).getPropertyValue("bottom"))return t}var n=document.querySelector("#credential_picker_iframe");if(n)return n}(),l=c.onetap.email_marketing&&null!==(t=c.onetap.statement)&&void 0!==t&&t.enable?null===(o=c.onetap.statement)||void 0===o?void 0:o.content:null===(a=c.onetap.marketing)||void 0===a?void 0:a.content;s?(s.style.bottom="58px",d.insertAdjacentHTML("beforeend","<style> .otc { position: fixed; bottom: 0px; left: 0px; z-index: ".concat(s.style.zIndex,'; width; 100%; height: 60px; padding: 0 8px 0 8px;} .otc > div {background-color: white; border-top: 1px solid #dadce0;}</style>\n                <div id="').concat(r,'" class="otc">').concat(l,"</div>"))):e.detail.width&&d.insertAdjacentHTML("beforeend","<style> .otc { width: ".concat(e.detail.width,'px; padding: 0 8px 0 8px;} .otc > div {background-color: white; border-radius: 8px; box-shadow: 0 0 0 1px #dadce0;}</style>\n                <div id="').concat(r,'" class="otc">').concat(l,"</div>"));var u=d.querySelector("#".concat(r));u&&u.addEventListener("click",(function(e){return e.stopPropagation()}))}else if("hide"===e.detail.action){var p=document.getElementById(r);p&&(p.style.display="none")}})),new Promise((function(e,t){var a=y(o);null!=a&&a.version?(c=a,e(a)):g("POST","/apps/authapp/load",{}).then((function(t){c=t,n.debug("init config"),b(o,t),e(t)})).catch((function(e){n.error(null==e?void 0:e.message),t()}))})).then((function(e){return c.delay?new Promise((function(t){setTimeout((function(){n.debug("delay ".concat(c.delay)),t(e)}),c.delay)})):Promise.resolve(e)})).then((function(e){if(c=e,s){if(t.enable){var i=y(t.key);if(null!=i&&i.return_url){b(t.key,_objectSpread(_objectSpread({},i),{},{return_url:!1}));var r=new URLSearchParams(window.location.search).get("return_url");if(r)return void window.location.replace("https://".concat(window.location.hostname).concat(decodeURIComponent(r)))}}!function(){var e,t,n=y(a);n&&(g("POST","/apps/authapp/user",{id:n,cid:s}),b(a));if(!(null!==(e=c.avatar)&&void 0!==e&&e.profile||null!==(t=c.avatar)&&void 0!==t&&t.header))return;var o=y("hiko_"+s);void 0!==(null==o?void 0:o.avatar)?I(o):g("POST","/apps/authapp/avatar",{id:s,social:c.click||""}).then((function(e){b("hiko_"+s,e),I(e)})).catch((function(){}))}()}else{if(t.enable){var d=y(t.key);if(null!=d&&d.replace)return b(t.key,_objectSpread(_objectSpread({},d),{},{replace:!1})),void window.location.replace(window.location.href)}var l,u,p;(document.querySelector('div[name="hiko-container"]')||document.querySelector('form[action*="/account"]'))&&P(),new Promise((function(e){var t=document.createElement("iframe");t.id="3pc",t.src="https://apps.hiko.link/js/assets/cookie.html",t.style.display="none",t.style.position="fixed",document.body.appendChild(t),window.addEventListener("message",(function o(a){if("3pcSupported"===a.data||"3pcUnsupported"===a.data){var i=!1;"3pcUnsupported"===a.data&&(i=!0,n.info("no 3'rd party cookie")),document.body.removeChild(t),window.removeEventListener("message",o),e(i)}}),!1)})).then(k),function(){try{var e=new MutationObserver((function(e){e.forEach((function(e){"attributes"===e.type&&"lang"===e.attributeName&&(b(o),P()),"childList"===e.type&&e.addedNodes.length>0&&e.addedNodes.forEach((function(e){if(e.nodeType===Node.ELEMENT_NODE&&(e.querySelector('form[action*="/account"]')&&P(),"FORM"===e.nodeName)){var t,o=_createForOfIteratorHelper(e.attributes);try{for(o.s();!(t=o.n()).done;){var a=t.value;"action"===a.name&&(n.debug("add form ".concat(a.value)),a.value.indexOf("/account")>=0&&P())}}catch(e){o.e(e)}finally{o.f()}}}))}))}));e.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"]}),e.observe(document.body,{childList:!0,subtree:!0})}catch(e){n.error(e.message)}}(),g("POST","/apps/authapp/load",{version:(l=y(o)).version,locale:l.locale}).then((function(e){var t;if(e.version&&l.version!==e.version||e.error){n.debug("config version ".concat(l.version," > ").concat(e.version)),b(o,e);var a=document.querySelectorAll('div[name="hiko-container"]');a.length&&(a.forEach((function(e){return e.remove})),c=e,P())}e.webview&&null!==(t=c.webview_hides)&&void 0!==t&&t.length&&document.querySelectorAll('div[name="hiko-container"]').forEach((function(e){c.webview_hides.forEach((function(t){var n=e.querySelector("div[data=".concat(t));n&&n.remove()}))}))})),null!==(u=c.ip)&&void 0!==u&&u.address||null!==(p=c.ip)&&void 0!==p&&p.disable||g("GET","https://api.ipify.org?format=json").then((function(e){null!=e&&e.ip&&(n.debug("ip ".concat(e.ip)),c.ip={address:e.ip},w(o,{ip:_objectSpread({},c.ip)}))})).catch((function(e){return n.debug("popup ip fail ".concat(null==e?void 0:e.message))}))}})))}}function h(e){var t,n;if(!c.onetap.email_marketing&&null!==(t=c.onetap.marketing)&&void 0!==t&&t.enable?"block":c.onetap.email_marketing&&null!==(n=c.onetap.statement)&&void 0!==n&&n.enable?"statement":null)if(e)m||(m=!0,document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:"iframe",width:e}})));else{var o=document.getElementById(i).querySelector("iframe");"0px"===getComputedStyle(o).getPropertyValue("bottom")&&document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:"iframe"}}))}}function v(){var e=document.documentElement.lang;return/^[A-Za-z]{2,4}([_-][A-Za-z]{4})?([_-]([A-Za-z]{2}|[0-9]{3}))?$/.test(e)?e:""}function g(t,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n.debug("ajax send ".concat(o)),++window.HIKO.ajax_calls>e)throw new Error("possible infinite met");return new Promise((function(e,n){var i=new XMLHttpRequest,r=function(e){var t=[];for(var n in e)t.push("".concat(n,"=").concat(encodeURIComponent(""+e[n]||"")));return t.join("&")}(_objectSpread(_objectSpread({},a),{},{app:"auth-app",href:encodeURIComponent(location.href),lang:v()}));"POST"===t?(i.open("POST","".concat(location.origin).concat(o),!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):i.open("GET",o.indexOf("http")<0?"https://apps.hiko.link".concat(o,"?").concat(r):o),i.onload=function(){204===i.status?e({}):200===i.status?e(JSON.parse(i.responseText)):n()},i.send(r)}))}function y(e){var t=sessionStorage.getItem(e);if(t)return JSON.parse(t)}function b(e,t){if(!e&&"string"!=typeof e)return n.error("invalid storage set");if(t)if(t.error){var o=JSON.parse(JSON.stringify(t));delete o.error,sessionStorage.setItem(e,JSON.stringify(o))}else sessionStorage.setItem(e,JSON.stringify(t));else sessionStorage.removeItem(e)}function w(e,t){b(e,_objectSpread(_objectSpread({},y(e)||{}),t))}function k(e){var t,o;if(null!==(t=c.onetap)&&void 0!==t&&t.enable&&!/.*\/account/.test(location.pathname))if(!(/(iPod|iPhone|iPad)/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))||c.onetap.safari)if(function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null}("onet"))n.warn("one tap supressed");else{var a=(null===(o=c.onetap.position)||void 0===o?void 0:o.maxWidth)||480;if(!1===c.onetap.mobile&&a>=window.innerWidth)n.debug("mobile disabled for width ".concat(window.innerWidth));else{!0===c.events&&(l=!0);var i=e||c.onetap.custom?x:A;c.onetap.delay?isNaN(c.onetap.delay)||setTimeout((function(){n.debug("delay due "+c.onetap.delay),i(S,e)}),1e3*c.onetap.delay):i(S,e)}}else n.warn("one tap not supported")}function S(e){var t,a=_objectSpread(_objectSpread({},e),{},{href:encodeURIComponent(location.href),lang:v(),cip:(null===(t=c.ip)||void 0===t?void 0:t.address)||""}),i=document.getElementById(r);if(i){var d=i.querySelector('input[type="checkbox"]');d&&(a.checked=""+d.checked,n.debug("one tap marketing conent ".concat(d.checked)))}l&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"onetap",social:"google"}})),document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"hide"}})),w(o,{click:"google"}),g("POST","/apps/authapp/onetap",a).then((function(e){e&&(e.token?(H(),j(e)):e.multipass?(H(),_(e)):(H(),O(e)))}))}function _(e){l&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"multipass",email:e.email,customer_id:e.customer_id,new_customer:e.new_customer}})),window.location.replace(e.multipass),t.enable&&b(t.key,t)}function E(e){n.debug(e),"display"===(null==e?void 0:e.g)&&null!=e&&e.h&&(n.debug("one tap block display"),function(){var e,t,n=document.getElementById(i);if(n){var o=!c.onetap.email_marketing&&null!==(e=c.onetap.marketing)&&void 0!==e&&e.enable?"block":c.onetap.email_marketing&&null!==(t=c.onetap.statement)&&void 0!==t&&t.enable?"statement":null;o&&document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:o}})),new MutationObserver((function(e){e.forEach((function(e){if("attributes"===e.type&&"credential_picker_container"===e.target.id&&!m){m=!0;var t=n.querySelector("iframe");o&&document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"display",type:o,width:t.offsetWidth}}))}}))})).observe(n,{subtree:!0,attributes:!0})}}(),g("POST","/apps/authapp/event",{name:"onetappop",path:location.pathname}).catch((function(e){return n.error(e.message)}))),"skipped"===(null==e?void 0:e.g)&&(n.debug("one tap block skipped"),document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"hide"}})))}function x(e,t){var o="onetap".concat((new Date).getTime());if(window[o]=e,t)n.debug("pop block in fedcm"),document.body.insertAdjacentHTML("beforeend",'<div id="'.concat(i,'"\n                        data-client_id="').concat(c.onetap.id,'"\n                        data-callback="').concat(o,'"\n                        data-itp_support="true"\n                        data-use_fedcm_for_prompt="true">\n                </div>'));else{var a,r,d,s=(null===(a=c.onetap.position)||void 0===a?void 0:a.right)||20,l=(null===(r=c.onetap.position)||void 0===r?void 0:r.top)||20,u=(null===(d=c.onetap.position)||void 0===d?void 0:d.zIndex)||999,p="momentCallback".concat((new Date).getTime());window[p]=E,n.debug("pop block location ".concat(s,", ").concat(l,", ").concat(u)),document.body.insertAdjacentHTML("beforeend",'<div id="'.concat(i,'"\n                    data-client_id="').concat(c.onetap.id,'"\n                    data-prompt_parent_id="').concat(i,'"\n                    data-callback="').concat(o,'"\n                    data-itp_support="true"\n                    data-moment_callback="').concat(p,'"\n                    style="position: absolute; right: ').concat(s,"px; top: ").concat(l,"px;  z-index: ").concat(u,';">\n                </div>'))}!function(e){var t=e.indexOf("http")>=0?e:"https://apps.hiko.link".concat(e);document.querySelectorAll('script[src^="'.concat(t,'"]')).length>0?Promise.resolve():new Promise((function(o){var a=document.createElement("script");a.src=t,a.defer="defer",a.async="async",a.onload=function(){n.debug("".concat(e," loaded")),o()},document.head.appendChild(a)}))}("https://accounts.google.com/gsi/client")}function A(e){var t,o,a,r;n.debug("poping one tap");var d="_".concat(Math.round(1e7*Math.random()).toString(36)),s=(null===(t=c.onetap.position)||void 0===t?void 0:t.right)||20,l=(null===(o=c.onetap.position)||void 0===o?void 0:o.top)||20,u=(null===(a=c.onetap.position)||void 0===a?void 0:a.zIndex)||999;n.debug("popping one tap frame ".concat(d,", ").concat(s,", ").concat(l,", ").concat(u));var p=document.createElement("style");p.innerHTML="\n              .".concat(d,"cz {position: fixed !important;  right: ").concat(s,"px; top: ").concat(l,"px;  z-index: ").concat(u,";}\n              .").concat(d,"z { border: none;}\n              @media screen and (max-width: ").concat((null===(r=c.onetap.position)||void 0===r?void 0:r.maxWidth)||480,"px) { .").concat(d,"z { position: fixed; bottom: 0px; left: 0px; z-index: 2147483647; width: 100%; height: 239px;  border: none; } }\n            ");var m=M('<div id="'.concat(i,'" style="display: none;" class="').concat(d,'cz"/>')),f=M('<iframe class="'.concat(d,'z" src="https://apps.hiko.link/js/assets/tap.html?v=').concat((new Date).getTime(),"&client=").concat(c.onetap.id,'"></iframe>'));m.append(f),document.body.append(p),document.body.append(m),h(),window.addEventListener("message",(function(t){if("size"===t.data.type)f.style.width=t.data.width+"px",f.style.height=t.data.height+"px",n.debug("one tap popup with (".concat(t.data.width,", ").concat(t.data.height,")")),h(t.data.width);else if("notification"===t.data.type){var o=t.data.notification.g,a=t.data.notification.h;n.debug("".concat(o," one tap, ").concat(JSON.stringify(t.data.notification))),"display"===o?!0===a?(m.style.display="block",g("POST","/apps/authapp/event",{name:"onetappop",path:location.pathname}).catch((function(e){return n.error(e.message)})),document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"popup",social:"google"}}))):!1===a&&(n.debug("display false"),m.remove()):"skipped"==o&&(m.style.display="none",function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var a="; expires="+o.toGMTString();document.cookie=e+"="+t+a+"; path=/"}("onet",t.data.notification.m),n.debug("user_cancel one tap"),document.dispatchEvent(new CustomEvent("onetap",{detail:{action:"hide"}})))}else"credential"===t.data.type&&e(t.data.token)}))}function O(e){l&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"login",email:e.email,customer_id:e.id}})),T(e.contextpath,{"customer[email]":e.email,"customer[password]":e.password})}function j(e){l&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"activate",customer_id:e.id}})),T(e.contextpath,{"customer[password]":e.password,"customer[password_confirmation]":e.password,token:e.token,utf8:"✓",id:e.id})}function T(e,n){var o=M('<form method="post" action="'.concat(e,'" style="display: none;"/>'));for(var a in n)n[a]&&o.insertAdjacentHTML("beforeend",'<input name="'.concat(a,'" value="').concat(n[a],'"/>'));document.body.append(o),o.submit(),t.enable&&b(t.key,t)}function P(){var e=function(){var e=document.querySelectorAll('div[name="hiko-container"]');if(e.length){var t,o=[],a=!1,i=_createForOfIteratorHelper(e);try{var r=function(){var e=t.value;""===e.getAttribute("ignore")?(a=!0,n.debug("ignore container"),e.querySelectorAll("div[data]").forEach((function(t){return t.onclick=function(){return z({button:t,container:e})}})),document.head.insertAdjacentHTML("beforeend",'<style id="hikoimages">'.concat(c.images,"</style>"))):o.push(e)};for(i.s();!(t=i.n()).done;)r()}catch(e){i.e(e)}finally{i.f()}return a?[]:o}if(/^(\/[a-zA-Z]{2,3}(-[a-zA-Z]{2})?)?\/cart($|\?)/.test(location.pathname))return[];var s=document.querySelectorAll('form[action*="/account"]'),l=[];return s.forEach((function(e){var t;if(!(e.querySelector('div[name="hiko-container"]')||(null===(t=e.action)||void 0===t?void 0:t.indexOf("/account/recover"))>=0))if(null!==e.querySelector("input[type=email]")||"portal-bosque.myshopify.com"!==d)if(e.querySelector('input[name="checkout_url"]')&&e.querySelector('input[name="guest"]'))n.debug("gest form, skip container");else{var o=e.action.indexOf("/account/login")>=0?M('<div name="hiko-container" type="login" app/>'):M('<div name="hiko-container" type="register" app/>');"top"===c.position?e.prepend(o):e.append(o),l.push(o)}else n.debug("no input email, skip container")})),l}();!0===c.events&&(l=!0),(null==e?void 0:e.length)>0&&(document.querySelectorAll("#hikostyles").forEach((function(e){return e.remove()})),document.querySelectorAll("#hikoimages").forEach((function(e){return e.remove()})),document.head.insertAdjacentHTML("beforeend",'<style id="hikostyles">'.concat(c.css,"</style>")),document.head.insertAdjacentHTML("beforeend",'<style id="hikoimages">'.concat(c.images,"</style>")),e.forEach((function(e){e.innerHTML="";var t=e.getAttribute("type")||"login",n=c.html[t];c.marketing_html&&(n+=c.marketing_html),e.insertAdjacentHTML("afterbegin",n),function(e){var t=e.querySelector(".".concat(c.classes.consent)),n=e.querySelectorAll(".".concat(c.classes.buttons," > div"));n.forEach((function(n){return n.onclick=function(){return z({button:n,consent:t,classes:c.classes,marketing:c.marketing,marketing_option:c.marketing_option,container:e})}}))}(e)}))),function(){var e,t=c,n=t.marketing,o=t.marketing_option,i=t.ip,r=_createForOfIteratorHelper(document.querySelectorAll('form[action*="/account"]'));try{var d=function(){var t=e.value;t.addEventListener("submit",(function(){var e,r,c=null===(e=t.querySelector('input[name="customer[password]"]'))||void 0===e?void 0:e.value,d=null===(r=t.querySelector('input[name="customer[email]"]'))||void 0===r?void 0:r.value,s=encodeURIComponent(Math.random().toString(36).substring(5)),l={id:s,email:d};if(null!=i&&i.address&&(l.cip=i.address),"always"===o)l.mkt="true";else if(n){var u=document.querySelector('input[name="'.concat(n,'"][type="checkbox"]'));u&&(l.mkt=u.checked)}d&&c&&s&&(b(a,s),g("POST","/apps/authapp/user",l))}))};for(r.s();!(e=r.n()).done;)d()}catch(e){r.e(e)}finally{r.f()}}()}function z(e){var t,a,i,r=e.button,s=e.consent,u=e.classes,p=e.marketing,m=e.marketing_option,f=e.container,h=r.getAttribute("data");if(n.debug("".concat(h," clicked")),l&&document.dispatchEvent(new CustomEvent("hiko",{detail:{social:h,action:"click"}})),s){var g=s.querySelector("input");if(g){if(!1===g.checked)return s.setAttribute("class",u.consent+" "+u.disagree);s.setAttribute("class",u.consent)}}var y={google:{width:450,height:680},facebook:{width:520,height:600},spotify:{width:520,height:470},twitter:{width:700,height:800},linkedin:{width:480,height:580},amazon:{width:420,height:630},line:{width:400,height:730},snapchat:{width:400,height:730},kakao:{width:400,height:680},tumblr:{width:430,height:760},twitch:{width:400,height:370},discord:{width:500,height:730},reddit:{width:860,height:620},vk:{width:680,height:450},tiktok:{width:400,height:620}},b=(null===(t=y[h])||void 0===t?void 0:t.width)||400,k=(null===(a=y[h])||void 0===a?void 0:a.height)||580;w(o,{click:h});var S=v(),_=function(){if("always"===m)return"true";if(p){var e=document.querySelector('input[name="'.concat(p,'"][type="checkbox"]'));if(e)return e.checked}return""}(),E=encodeURIComponent(location.href),x=(new Date).getTime(),A=(null==f?void 0:f.getAttribute("register_tag"))||"",O=(null===(i=c.ip)||void 0===i?void 0:i.address)||"";try{window.addEventListener("message",q,!1),window.open("https://apps.hiko.link/js/login.html?social=".concat(h,"&shop=").concat(d,"&href=").concat(E,"&lang=").concat(S,"&mkt=").concat(_,"&register_tag=").concat(A,"&cip=").concat(O,"&ts=").concat(x),"Login social","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=".concat(b,", height=").concat(k)).focus()}catch(e){n.debug("redirecting ..."),T("https://apps.hiko.link/admin/auth",{social:h,shop:d,href:E,lang:S})}}function q(e){n.debug("received from popup ".concat(e.origin)),e.data.en&&L(e.data.en).then(C)}function L(e){var t=new TextEncoder("hex"),n=new TextDecoder("utf8");return crypto.subtle.importKey("raw",t.encode(d.substring(0,16)),"AES-GCM",!0,["decrypt"]).then((function(n){return crypto.subtle.decrypt({name:"AES-GCM",iv:t.encode(d.replace(".","").substring(0,16))},n,new Uint8Array(e.match(/../g).map((function(e){return parseInt(e,16)}))).buffer)})).then((function(e){return JSON.parse(n.decode(e))}))}function C(e){"login"===e.name?(H(),O(e.data)):"multipass"===e.name?(H(),_(e.data)):"activate"===e.name?(H(),j(e.data)):"error"===e.name&&function(e){var t=e.code,n=e.type,o=e.email,a=e.message;l&&document.dispatchEvent(new CustomEvent("hiko",{detail:{action:"error",message:a}}));if(o&&541===t){var i=document.querySelectorAll('input[name="customer[email]"]');i.length&&i.forEach((function(e){return e.value=o}))}document.querySelectorAll('div[name="hiko-err"]').forEach((function(e){e.innerHTML="";var t=document.createElement("div");e.append(t),"error"===n?(t.setAttribute("class","form-message form-message--error errors"),t.insertAdjacentHTML("beforeend",'<i class="fas fa-exclamation-circle"/>')):"warning"===n?(t.setAttribute("class","form-message form-message--success"),t.insertAdjacentHTML("beforeend",'<i class="fas fa-exclamation"/>')):(t.setAttribute("form-message form-message--success"),t.insertAdjacentHTML("beforeend",'<i class="fas fa-check-circle"/>')),t.append(document.createTextNode(" "+a))}))}(e.data)}function I(e){if(null!=e&&e.avatar){var t=function(e){var t=e.first_name,n=e.last_name;if(!t&&!n)return"";if(t&&n)return"".concat(t," ").concat(n);if(t)return t;if(n)return n}(e),n=document.querySelectorAll('[name="hiko-avatar"]');if(n.length)n.forEach((function(n){if(e.avatar){if("IMG"===n.tagName)n.setAttribute("src",e.avatar),n.setAttribute("title",t);else if("A"===n.tagName){var o=n.querySelector("img");o?(o.setAttribute("src",e.avatar),o.setAttribute("title",t)):n.insertAdjacentHTML("beforeend",'<img src="'.concat(e.avatar,'" title="').concat(t,'"/>'))}n.style.dispay="block"}}));else if(/^(\/[a-zA-Z]{2,3}(-[a-zA-Z]{2})?)?\/account($|\?)/.test(location.pathname)){var o;if(null===(o=c.avatar)||void 0===o||!o.profile)return;var a=document.querySelector("a[href*='/account/addresses']");if(a){var i,r,d='<img src="'.concat(e.avatar,'" title="').concat(t,'" alt="').concat(t,'" style="border-radius: 20%;width: 64px;height: 64px;margin-top: 10px"/>');null!==(i=c.avatar)&&void 0!==i&&i.profile_link&&(d='<a href="'.concat(null===(r=c.avatar)||void 0===r?void 0:r.profile_link,'">').concat(d,"</a>"));var s=M(d);a.parentNode.after(s),s.after(M("<p><bold>".concat(t,"</bold></p>")))}}else{var l;if(null===(l=c.avatar)||void 0===l||!l.header)return;var u=document.querySelectorAll("a[href*='/account']");if(u.length){var p,m,f='<img src="'.concat(e.avatar,'" class="icon" title="').concat(t,'" alt="').concat(t,'" style="border-radius: 20%;width: 24px;height: 24px"/>');null!==(p=c.avatar)&&void 0!==p&&p.header_link&&(f='<a href="'.concat(null===(m=c.avatar)||void 0===m?void 0:m.header_link,'">').concat(f,"</a>"));var h=M(f);u.forEach((function(e){if(e.href&&e.href.match(/.*\/account$/)&&e.closest("header")){var t=e.cloneNode();t.append(h),e.after(t)}}))}}}}function M(e){var t=document.createElement("div");return t.innerHTML=e,1!==t.childElementCount&&n.error("childrens "+t.childElementCount+", "+e),t.firstChild}function H(){document.body.insertAdjacentHTML("beforeend",'<style>\n        .hikoloading {\n          position: absolute;\n          top: 0;\n          left: 0;\n          z-index: 100;\n          width: 100vw;\n          height: 400vh;\n          background-color: rgba(192, 192, 192, 0.5);\n          background-repeat: no-repeat;\n          background-position: center;\n        }\n        .hikospinner {\n          position: fixed;\n          top: 50%;\n          left: 50%;\n          margin: auto;\n          width: 50px;\n          height: 50px;\n          -webkit-animation-name: hikospin;\n          -webkit-animation-duration: 2000ms;\n          -webkit-animation-iteration-count: infinite;\n          -webkit-animation-timing-function: linear;\n          -moz-animation-name: hikospin;\n          -moz-animation-duration: 2000ms;\n          -moz-animation-iteration-count: infinite;\n          -moz-animation-timing-function: linear;\n          -ms-animation-name: hikospin;\n          -ms-animation-duration: 2000ms;\n          -ms-animation-iteration-count: infinite;\n          -ms-animation-timing-function: linear;\n          animation-name: hikospin;\n          animation-duration: 2000ms;\n          animation-iteration-count: infinite;\n          animation-timing-function: linear;\n        }\n      \n        @-ms-keyframes hikospin {\n          from {\n            -ms-transform: rotate(0deg);\n          }\n          to {\n            -ms-transform: rotate(360deg);\n          }\n        }\n      \n        @-moz-keyframes hikospin {\n          from {\n            -moz-transform: rotate(0deg);\n          }\n          to {\n            -moz-transform: rotate(360deg);\n          }\n        }\n      \n        @-webkit-keyframes hikospin {\n          from {\n            -webkit-transform: rotate(0deg);\n          }\n          to {\n            -webkit-transform: rotate(360deg);\n          }\n        }\n      \n        @keyframes hikospin {\n          from {\n            transform: rotate(0deg);\n          }\n          to {\n            transform: rotate(360deg);\n          }\n        }\n      </style>\n      \n      <div class="hikoloading">\n        <div class="hikospinner">\n          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4335 4335" width="50" height="50">\n            <path\n              fill="black"\n              d="M3346 1077c41,0 75,34 75,75 0,41 -34,75 -75,75 -41,0 -75,-34 -75,-75 0,-41 34,-75 75,-75zm-1198 -824c193,0 349,156 349,349 0,193 -156,349 -349,349 -193,0 -349,-156 -349,-349 0,-193 156,-349 349,-349zm-1116 546c151,0 274,123 274,274 0,151 -123,274 -274,274 -151,0 -274,-123 -274,-274 0,-151 123,-274 274,-274zm-500 1189c134,0 243,109 243,243 0,134 -109,243 -243,243 -134,0 -243,-109 -243,-243 0,-134 109,-243 243,-243zm500 1223c121,0 218,98 218,218 0,121 -98,218 -218,218 -121,0 -218,-98 -218,-218 0,-121 98,-218 218,-218zm1116 434c110,0 200,89 200,200 0,110 -89,200 -200,200 -110,0 -200,-89 -200,-200 0,-110 89,-200 200,-200zm1145 -434c81,0 147,66 147,147 0,81 -66,147 -147,147 -81,0 -147,-66 -147,-147 0,-81 66,-147 147,-147zm459 -1098c65,0 119,53 119,119 0,65 -53,119 -119,119 -65,0 -119,-53 -119,-119 0,-65 53,-119 119,-119z"\n            ></path>\n          </svg>\n        </div>\n      </div>')}}();
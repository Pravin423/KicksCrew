(function(){function r(){var e=null;if(window.braze!==undefined){e=window.braze}else if(window.appboy!==undefined){e=window.appboy}return e}function o(e){const t=100;window.setTimeout(function(){if(r()!==null&&r().getUser()){e()}else{o(e)}},t)}function s(e,o,n){fetch(e+".js").then(e=>e.json()).then(e=>{var t={id:e.id,title:e.title,price:e.price,vendor:e.vendor,images:e.images,shopify_storefront:n};r().logCustomEvent(o,t);r().requestImmediateDataFlush()})}function n(){const e=new URL([...document.getElementsByTagName("script")].map(e=>e.src).find(e=>e.includes("braze-product-script")));const t=new URLSearchParams(e.search);return Object.fromEntries(t.entries())}function a(e){const t=e.lastIndexOf("/")+1;const o=e.indexOf("?")>0?e.indexOf("?"):e.length;return e.substring(t,o)}function c(e,t,o,n,r,i){productName=a(t);const c=JSON.parse(localStorage.getItem(o)||"{}");lastEventTimeForProduct=c[productName]||0;if(r-lastEventTimeForProduct>i){c[productName]=r;localStorage.setItem(o,JSON.stringify(c));s(t,e,n)}}o(function(){currentPath=window.location.pathname;now=Date.now();oneDayMillis=864e5;const t=n();const r="viewed_products";var i;try{i=Shopify.shop}catch(e){console.warn("Unable to get shop_name from 'Shopify' JS object: "+e);i=t["shop_domain"]}if(currentPath.includes("/products/")){if(t["product_click"]=="true"){c("shopify_product_clicked",currentPath,"clicked_products",i,now,oneDayMillis)}if(t["product_view"]=="true"){c("shopify_product_viewed",currentPath,r,i,now,oneDayMillis)}}if(t["product_view"]=="true"){const e=new IntersectionObserver(function(e,t){const o=JSON.parse(localStorage.getItem(r)||"{}");for(const n of e){if(n.isIntersecting===true){productName=a(n.target.href);productLastViewedAt=o[productName]||0;if(now-productLastViewedAt>oneDayMillis){o[productName]=now;s("/products/"+productName,"shopify_product_viewed",i)}t.unobserve(n.target)}}localStorage.setItem(r,JSON.stringify(o))},{threshold:[1]});products=document.querySelectorAll("[href*='/products/']");for(const o of products){if(o.host==t["shop"]){e.observe(o)}}}})})();